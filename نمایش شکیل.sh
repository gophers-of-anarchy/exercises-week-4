awk -F\| 'NR==1 {for (i=1; i<=NF; i++) printf "col%d%s", i, (i<NF ? " - " : "\n")} NR>0 {for (i=1; i<=NF; i++) {if(i == NF) {sum+=$i}; printf "%s%s", $i, (i<NF ? " - " : "\n")}} END{print sum}' data.txt